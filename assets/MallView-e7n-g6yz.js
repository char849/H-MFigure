import{a as _,x as A,o as B,e as u,f as e,F as $,j as w,y as C,t as b,g as d,w as E,i as D,b as v,d as c,k as j,h as V,q as I,v as O,n as g,z as H}from"./index-OTk8KeOx.js";import{a as m}from"./axios-L6U4YIEh.js";var z={VITE_API:"https://vue3-course-api.hexschool.io/v2/",VITE_PATH:"charlotte-lee849",BASE_URL:"/H-MFigure/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const J={class:"container-fulid box-bg09"},G={key:0,class:"container mt-6 mt-md-7 mb-6 mb-md-5"},K=D('<ul class="row justify-content-center list-unstyled py-3 px-3"><li class="col-md-4"><div class="bg-danger p-3 badge rounded-pill fs-3 w-100 mb-2 bg-secondary text-white"> 1. 填寫資料 </div></li><li class="col-md-4"><div class="p-3 badge rounded-pill fs-3 w-100 mb-2 bg-info text-muted"> 2. 課程結帳 </div></li><li class="col-md-4"><div class="p-3 badge rounded-pill fs-3 w-100 mb-2 bg-info text-muted"> 3. 付款完成 </div></li></ul><div class="col-12 text-dark mt-1 mt-md-4"><div class="mx-auto text-center OBJECTS"><div class="fw-bold title mb-0">預約課程清單</div><span class="text-info fs-4">Course Reservation List</span></div></div>',2),Q={class:"row justify-content-center order mx-1"},W={class:"col-12 col-md-8"},X={class:"col-12"},Y={class:"text-end"},Z=["disabled"],ee={class:"table align-middle"},te=e("thead",null,[e("tr",null,[e("th"),e("th",null,"課程名稱"),e("th",{style:{width:"130px"}},"上課人數"),e("th"),e("th",{class:"text-center"},"總價")])],-1),se=["onClick","disabled"],ae={class:"input-group input-group-sm"},le={class:"input-group my-3"},oe=["onUpdate:modelValue","onChange","disabled"],de=["value"],ne={class:"input-group-text",id:"basic-addon2"},ce=e("td",null,null,-1),ie={class:"text-end"},re=e("td",{colspan:"4",class:"text-end"},"總計",-1),ue={class:"text-end"},me={class:"col-12"},pe={class:"d-flex justify-content-center mt-5 mt-md-7"},_e={class:"mb-3"},be=e("div",{class:"mt-2 mb-4 fs-3 ms-1 fw-medium text-dark text-center"},[e("i",{class:"bi bi-feather fs-1 me-2"}),V(" 請填寫個人資料 ")],-1),ve=e("label",{for:"email",class:"form-label"},"Email",-1),he={class:"mb-3"},fe=e("label",{for:"name",class:"form-label"},"同學姓名",-1),ge={class:"mb-3"},ye=e("label",{for:"tel",class:"form-label"},"同學電話",-1),xe={class:"mb-3"},Ve=e("label",{for:"address",class:"form-label"},"同學地址",-1),ke={class:"mb-3"},$e=e("label",{for:"message",class:"form-label"},"留言",-1),we={class:"text-end mb-0 mb-md-5"},Ce=["disabled"],Ee={key:1,class:"text-center mb-7 mb-md-9 pt-7 pt-md-9"},Ie=e("h2",{class:"text-info"},"返回模型課程",-1),Re=e("p",{class:"display-3 text-info my-4 mb-md-6"},"預約課程列表目前尚無課程!!!",-1),Le={__name:"MallView",setup(Te){const{VITE_API:i,VITE_PATH:r}=z,k=_(null),n=_({carts:[]}),R=_([]),y=_(""),o=_({user:{name:"",email:"",tel:"",address:""},message:""}),T=A(),q=t=>/(^09|\+?8869)\d{2}(-?\d{3}-?\d{3})$/.test(t)?!0:"需要正確的電話號碼",F=()=>{m.get(`${i}api/${r}/products/all`).then(t=>{R.value=t.data.products}).catch(t=>{alert(t.response.data.message)})},p=()=>{m.get(`${i}api/${r}/cart`).then(t=>{n.value=t.data.data}).catch(t=>{alert(t.response.data.message)})},L=t=>{m.delete(`${i}/api/${r}/cart/${t}`).then(()=>{p()}).catch(s=>{alert(s.response.data.message)})},M=()=>{m.delete(`${i}/api/${r}/carts`).then(()=>{p()}).catch(t=>{alert(t.response.data.message)})},S=t=>{const s={product_id:t.product_id,qty:t.qty};m.put(`${i}/api/${r}/cart/${t.id}`,{data:s}).then(()=>{p()}).catch(x=>{alert(x.response.data.message)})},U=()=>{const t=o.value;m.post(`${i}api/${r}/order`,{data:t}).then(s=>{y.value=s.data.orderId,T.push(`/order/${y.value}`),console.log(y.value),k.value.resetForm(),p()}).catch(s=>{alert(s.response.data.message)})};return B(()=>{F(),p()}),(t,s)=>{const x=v("font-awesome-icon"),h=v("VeeField"),f=v("ErrorMessage"),N=v("VeeForm"),P=v("RouterLink");return c(),u("div",J,[n.value.carts.length>0?(c(),u("div",G,[K,e("div",Q,[e("div",W,[e("div",X,[e("div",Y,[e("button",{class:"btn btn-outline-danger rounded-pill my-2 my-md-3 my-xl-5 ps-6 pe-5 py-3 mb-4",type:"button",onClick:M,disabled:n.value.carts.length===0}," 清空預約課程 ",8,Z)]),e("table",ee,[te,e("tbody",null,[n.value.carts?(c(!0),u($,{key:0},w(n.value.carts,a=>(c(),u("tr",{key:a.id},[e("td",null,[e("button",{type:"button",id:"btn01",class:"btn btn-outline-secondary btn-sm",onClick:l=>L(a.id),disabled:t.isLoadingItem===a.id},[t.isLoadingItem===a.id?(c(),j(x,{key:0,icon:"spinner",pulse:""})):C("",!0),V(" x ")],8,se)]),e("td",null,b(a.product.title),1),e("td",null,[e("div",ae,[e("div",le,[I(e("select",{class:"form-select","onUpdate:modelValue":l=>a.qty=l,onChange:l=>S(a),disabled:t.isLoadingItem===a.id},[(c(),u($,null,w(5,l=>e("option",{value:l,key:`${l}-${a.id}`},b(l),9,de)),64))],40,oe),[[O,a.qty]]),e("span",ne,b(a.product.unit),1)])])]),ce,e("td",ie,b(t.$filters.currency(a.total)),1)]))),128)):C("",!0)]),e("tfoot",null,[e("tr",null,[re,e("td",ue,b(t.$filters.currency(n.value.total)),1)])])])]),e("div",me,[e("div",pe,[d(N,{ref_key:"formRef",ref:k,class:"col-12",onSubmit:U},{default:E(({errors:a})=>[e("div",_e,[be,ve,d(h,{id:"email",name:"email",type:"email",class:g(["form-control",{"is-invalid":a.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:o.value.user.email,"onUpdate:modelValue":s[0]||(s[0]=l=>o.value.user.email=l)},null,8,["class","modelValue"]),d(f,{name:"email",class:"invalid-feedback"})]),e("div",he,[fe,d(h,{id:"name",name:"姓名",type:"text",class:g(["form-control",{"is-invalid":a.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:o.value.user.name,"onUpdate:modelValue":s[1]||(s[1]=l=>o.value.user.name=l)},null,8,["class","modelValue"]),d(f,{name:"姓名",class:"invalid-feedback"})]),e("div",ge,[ye,d(h,{id:"tel",name:"電話",type:"tel",class:g(["form-control",{"is-invalid":a.電話}]),placeholder:"請輸入電話",rules:q,modelValue:o.value.user.tel,"onUpdate:modelValue":s[2]||(s[2]=l=>o.value.user.tel=l)},null,8,["class","modelValue"]),d(f,{name:"電話",class:"invalid-feedback"})]),e("div",xe,[Ve,d(h,{id:"address",name:"地址",type:"text",class:g(["form-control",{"is-invalid":a.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:o.value.user.address,"onUpdate:modelValue":s[3]||(s[3]=l=>o.value.user.address=l)},null,8,["class","modelValue"]),d(f,{name:"地址",class:"invalid-feedback"})]),e("div",ke,[$e,I(e("textarea",{name:"",id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":s[4]||(s[4]=l=>o.value.message=l)},null,512),[[H,o.value.message]])]),e("div",we,[e("button",{type:"submit",class:"btn btn-danger rounded-pill my-2 my-md-3 my-xl-4 ps-6 pe-5 py-3",disabled:Object.keys(a).length>0||n.value.carts.length===0}," 送出訂單 ",8,Ce)])]),_:1},512)])])])])])):(c(),u("div",Ee,[Ie,Re,d(P,{to:"/products",class:"fs-5 btn btn-danger rounded-5 py-3 px-5"},{default:E(()=>[V(" 去逛逛吧 ! ")]),_:1})]))])}}};export{Le as default};
