import{a as E}from"./axios-L6U4YIEh.js";import{S as I}from"./sweetalert2.all-jFvQ2qQ1.js";import{u as C}from"./useModal-plUv8KgV.js";import{o as n,c as d,b as e,e as A,t as M,A as L,r as _,u as o,m as a,x as c,i as F,F as T,h as D,B as H,g as B,a as O,d as P}from"./index-IqNpjolQ.js";import{_ as N}from"./PaginationComponent-sAMmb6zh.js";import"./selector-engine-BgExtCN1.js";var j={VITE_API:"https://vue3-course-api.hexschool.io/v2/",VITE_PATH:"charlotte-lee849",BASE_URL:"/H-MFigure/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const G={class:"modal-dialog"},z={class:"modal-content border-0"},q=e("div",{class:"modal-header bg-danger text-white"},[e("h5",{id:"delProductModalLabel",class:"modal-title"},[e("span",null,"刪除產品")]),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),J={class:"modal-body"},K={class:"text-danger"},Q=e("button",{type:"button",class:"btn btn-outline-danger","data-bs-dismiss":"modal"}," 取消 ",-1),W={__name:"DelModal",props:{tempProduct:Object},emits:["get-data"],setup(k,{expose:$,emit:V}){const{openModal:m,hideModal:b,modalRef:h,defineEmits:t}=C(),v=k,g=V,{VITE_API:U,VITE_PATH:p}=j,y=()=>{const r=`${U}api/${p}/admin/product/${v.tempProduct.id}`;E.delete(r).then(i=>{I.fire(i.data.message),b(),g("get-data")})};return $({openModal:m,hideModal:b}),(r,i)=>(n(),d("div",{id:"delModal",ref_key:"modalRef",ref:h,class:"modal fade",tabindex:"-1","aria-labelledby":"delModalLabel","aria-hidden":"true"},[e("div",G,[e("div",z,[q,e("div",J,[A(" 是否刪除 "),e("strong",K,M(k.tempProduct.title),1),A(" 商品(刪除後將無法恢復)。 ")]),e("div",{class:"modal-footer"},[Q,e("button",{type:"button",class:"btn btn-danger",onClick:y}," 確認刪除 ")])])])],512))}};var X={VITE_API:"https://vue3-course-api.hexschool.io/v2/",VITE_PATH:"charlotte-lee849",BASE_URL:"/H-MFigure/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const Y={class:"modal-dialog modal-xl"},Z={class:"modal-content border-0"},ee={class:"modal-header bg-dark text-white"},te={id:"productModalLabel",class:"modal-title"},oe={key:0},le={key:1},se=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),ae={class:"modal-body"},ne={class:"row"},de={class:"col-sm-4"},ie={class:"mb-3"},ce=e("label",{for:"imageUrl",class:"form-label"},"主要圖片",-1),re={class:"mb-3"},ue={for:"customFile",class:"form-label"},me={key:0,class:"fas fa-spinner fa-spin"},pe=["src"],_e=e("h3",{class:"mb-3"},"多圖新增",-1),be={key:0},fe={class:"mb-3"},he=e("label",{for:"imageUrl",class:"form-label"},"圖片網址",-1),ve=["onUpdate:modelValue"],ge=["src"],ye={key:0},Ue={key:1},xe={key:1},ke={class:"col-sm-8"},$e={class:"mb-3"},Ve=e("label",{for:"title",class:"form-label"},"課程名稱",-1),we={class:"row"},Me={class:"mb-3 col-md-6"},Pe=e("label",{for:"category",class:"form-label"},"課程分類",-1),Ee={class:"mb-3 col-md-6"},Ie=e("label",{for:"unit",class:"form-label"},"單位",-1),Te={class:"row"},Re={class:"mb-3 col-md-6"},Ae=e("label",{for:"origin_price",class:"form-label"},"課程原價",-1),Ce={class:"mb-3 col-md-6"},De=e("label",{for:"price",class:"form-label"},"課程售價",-1),Se={class:"row"},Le={class:"mb-3 col-md-6"},Fe=e("label",{for:"level",class:"form-label"},"難易程度",-1),He={class:"mb-3 col-md-6"},Be=e("label",{for:"time",class:"form-label"},"課程時間",-1),Oe={class:"row"},Ne={class:"mb-3 col-md-6"},je=e("label",{for:"hr",class:"form-label"},"課程時數",-1),Ge={class:"mb-3 col-md-6"},ze=e("label",{for:"people",class:"form-label"},"上課人數",-1),qe={class:"row"},Je={class:"mb-3 col-md-6"},Ke=e("label",{for:"week",class:"form-label"},"一週天數",-1),Qe={class:"mb-3 col-md-6"},We=e("label",{for:"location",class:"form-label"},"上課地點",-1),Xe=e("hr",null,null,-1),Ye={class:"mb-3"},Ze=e("label",{for:"description",class:"form-label"},"注意事項",-1),et={class:"mb-3"},tt=e("label",{for:"content",class:"form-label"},"說明內容",-1),ot={class:"mb-3"},lt={class:"form-check"},st=e("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),at=e("button",{type:"button",class:"btn btn-outline-dark","data-bs-dismiss":"modal"}," 取消 ",-1),nt={__name:"ProductModal",props:{tempProduct:Object,isNew:Boolean},emits:["get-data"],setup(k,{expose:$,emit:V}){const{VITE_API:m,VITE_PATH:b}=X,h=k,{tempProduct:t,isNew:v}=L(h),g=V,{openModal:U,hideModal:p,modalRef:y}=C(),r=_(null),i=_({}),f=()=>{let w=`${m}api/${b}/admin/product`,l="post";v.value||(w=`${m}api/${b}/admin/product/${t.value.id}`,l="put"),E[l](w,{data:t.value}).then(s=>{I.fire(s.data.message),p(),g("get-data")}).catch(s=>{I.fire(s.response.data.message)})},u=()=>{t.value.imagesUrl=[""],t.value.imagesUrl.push("")},R=()=>{const w=r.value.files[0],l=new FormData;l.append("file-to-upload",w);const s="https://vue3-course-api.hexschool.io/v2//api/charlotte-lee849/admin/upload";i.value.fileUploading=!0,E.post(s,l,{headers:{"Content-Type":"multipart/form-data"}}).then(x=>{i.value.fileUploading=!1,x.data.success&&(t.value.imageUrl=x.data.imageUrl),r.value.value=""}).catch(()=>{i.value.fileUploading=!1})};return $({openModal:U,hideModal:p}),(w,l)=>(n(),d("div",{id:"productModal",ref_key:"modalRef",ref:y,class:"modal fade",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"},[e("div",Y,[e("div",Z,[e("div",ee,[e("h5",te,[o(v)?(n(),d("span",oe,"新增產品")):(n(),d("span",le,"編輯產品"))]),se]),e("div",ae,[e("div",ne,[e("div",de,[e("div",ie,[ce,a(e("input",{"onUpdate:modelValue":l[0]||(l[0]=s=>o(t).imageUrl=s),type:"text",class:"form-control mb-2",placeholder:"請輸入圖片連結"},null,512),[[c,o(t).imageUrl]]),e("div",re,[e("label",ue,[A("或 上傳圖片 "),i.value.fileUploading?(n(),d("i",me)):F("",!0)]),e("input",{type:"file",id:"customFile",class:"form-control",ref_key:"fileInputRef",ref:r,onChange:R},null,544)]),e("img",{class:"img-fluid",src:o(t).imageUrl},null,8,pe)]),_e,Array.isArray(o(t).imagesUrl)?(n(),d("div",be,[(n(!0),d(T,null,D(o(t).imagesUrl,(s,x)=>(n(),d(T,{key:x},[e("div",fe,[he,a(e("input",{"onUpdate:modelValue":S=>o(t).imagesUrl[x]=S,type:"text",class:"form-control",placeholder:"請輸入圖片連結"},null,8,ve),[[c,o(t).imagesUrl[x]]])]),e("img",{class:"img-fluid",src:s},null,8,ge)],64))),128)),!o(t).imagesUrl.length||o(t).imagesUrl[o(t).imagesUrl.length-1]?(n(),d("div",ye,[e("button",{class:"btn btn-outline-primary btn-sm d-block w-100",onClick:l[1]||(l[1]=s=>o(t).imagesUrl.push(""))}," 新增圖片 ")])):(n(),d("div",Ue,[e("button",{class:"btn btn-outline-danger btn-sm d-block w-100",onClick:l[2]||(l[2]=s=>o(t).imagesUrl.pop())}," 刪除圖片 ")]))])):(n(),d("div",xe,[e("button",{class:"btn btn-outline-primary btn-sm d-block w-100",onClick:u}," 新增圖片 ")]))]),e("div",ke,[e("div",$e,[Ve,a(e("input",{id:"title","onUpdate:modelValue":l[3]||(l[3]=s=>o(t).title=s),type:"text",class:"form-control",placeholder:"請輸入課程名稱"},null,512),[[c,o(t).title]])]),e("div",we,[e("div",Me,[Pe,a(e("input",{id:"category","onUpdate:modelValue":l[4]||(l[4]=s=>o(t).category=s),type:"text",class:"form-control",placeholder:"請輸入課程分類"},null,512),[[c,o(t).category]])]),e("div",Ee,[Ie,a(e("input",{id:"unit","onUpdate:modelValue":l[5]||(l[5]=s=>o(t).unit=s),type:"text",class:"form-control",placeholder:"請輸入單位"},null,512),[[c,o(t).unit]])])]),e("div",Te,[e("div",Re,[Ae,a(e("input",{id:"origin_price","onUpdate:modelValue":l[6]||(l[6]=s=>o(t).origin_price=s),type:"number",min:"0",class:"form-control",placeholder:"請輸入課程原價"},null,512),[[c,o(t).origin_price,void 0,{number:!0}]])]),e("div",Ce,[De,a(e("input",{id:"price","onUpdate:modelValue":l[7]||(l[7]=s=>o(t).price=s),type:"number",min:"0",class:"form-control",placeholder:"請輸入課程售價"},null,512),[[c,o(t).price,void 0,{number:!0}]])])]),e("div",Se,[e("div",Le,[Fe,a(e("input",{id:"level","onUpdate:modelValue":l[8]||(l[8]=s=>o(t).level=s),type:"text",class:"form-control",placeholder:"請輸入難易程度"},null,512),[[c,o(t).level]])]),e("div",He,[Be,a(e("input",{id:"time","onUpdate:modelValue":l[9]||(l[9]=s=>o(t).time=s),type:"text",class:"form-control",placeholder:"請輸入課程時間"},null,512),[[c,o(t).time]])])]),e("div",Oe,[e("div",Ne,[je,a(e("input",{id:"hr","onUpdate:modelValue":l[10]||(l[10]=s=>o(t).hr=s),type:"text",class:"form-control",placeholder:"請輸入課程時數"},null,512),[[c,o(t).hr]])]),e("div",Ge,[ze,a(e("input",{id:"people","onUpdate:modelValue":l[11]||(l[11]=s=>o(t).people=s),type:"text",class:"form-control",placeholder:"請輸入上課人數"},null,512),[[c,o(t).people]])])]),e("div",qe,[e("div",Je,[Ke,a(e("input",{id:"week","onUpdate:modelValue":l[12]||(l[12]=s=>o(t).week=s),type:"text",class:"form-control",placeholder:"請輸入一週天數"},null,512),[[c,o(t).week]])]),e("div",Qe,[We,a(e("input",{id:"location","onUpdate:modelValue":l[13]||(l[13]=s=>o(t).location=s),type:"text",class:"form-control",placeholder:"請輸入上課地點"},null,512),[[c,o(t).location]])])]),Xe,e("div",Ye,[Ze,a(e("textarea",{id:"description","onUpdate:modelValue":l[14]||(l[14]=s=>o(t).description=s),type:"text",class:"form-control",placeholder:"請輸入注意事項"},`
                  `,512),[[c,o(t).description]])]),e("div",et,[tt,a(e("textarea",{id:"content","onUpdate:modelValue":l[15]||(l[15]=s=>o(t).content=s),type:"text",class:"form-control",placeholder:"請輸入說明內容"},`
                  `,512),[[c,o(t).content]])]),e("div",ot,[e("div",lt,[a(e("input",{id:"is_enabled","onUpdate:modelValue":l[16]||(l[16]=s=>o(t).is_enabled=s),class:"form-check-input",type:"checkbox","true-value":1,"false-value":0},null,512),[[H,o(t).is_enabled]]),st])])])])]),e("div",{class:"modal-footer"},[at,e("button",{type:"button",class:"btn btn-danger",onClick:f}," 確認 ")])])])],512))}};var dt={VITE_API:"https://vue3-course-api.hexschool.io/v2/",VITE_PATH:"charlotte-lee849",BASE_URL:"/H-MFigure/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const it={class:"container"},ct={class:"text-end mt-8"},rt={class:"table mt-4"},ut=e("thead",null,[e("tr",null,[e("th",{width:"120"},"課程分類"),e("th",null,"課程名稱"),e("th",{width:"120"},"課程原價"),e("th",{width:"120"},"課程售價"),e("th",{width:"100"},"是否上架"),e("th",{width:"120"},"編輯課程")])],-1),mt={class:"text-end"},pt={class:"text-end"},_t={key:0,class:"text-success"},bt={key:1},ft={class:"btn-group"},ht=["onClick"],vt=["onClick"],Vt={__name:"AdminCourses",setup(k){const{VITE_API:$,VITE_PATH:V}=dt,m=_(!1),b=_([]),h=_(!1),t=_({imagesUrl:[]}),v=_({}),g=_(null),U=_(null),p=(r=1)=>{const i=`${$}api/${V}/admin/products/?page=${r}`;m.value=!0,E.get(i).then(f=>{m.value=!1,b.value=f.data.products,v.value=f.data.pagination}).catch(f=>{m.value=!1,I.fire(f.response.data.message)})},y=(r,i)=>{r==="new"?(t.value={imagesUrl:[]},h.value=!0,g.value.openModal()):r==="edit"?(t.value={...i},h.value=!1,g.value.openModal()):r==="delete"&&(t.value={...i},U.value.openModal())};return B(()=>{p()}),(r,i)=>{const f=O("VueLoading");return n(),d(T,null,[e("div",it,[e("div",ct,[e("button",{class:"btn btn-danger",onClick:i[0]||(i[0]=u=>y("new"))}," 建立新課程 ")]),e("table",rt,[P(f,{active:m.value,"z-index":1060,class:"text-center"},null,8,["active"]),ut,e("tbody",null,[(n(!0),d(T,null,D(b.value,u=>(n(),d("tr",{key:u.id},[e("td",null,M(u.category),1),e("td",null,M(u.title),1),e("td",mt,M(u.origin_price),1),e("td",pt,M(u.price),1),e("td",null,[u.is_enabled?(n(),d("span",_t,"啟用")):(n(),d("span",bt,"未啟用"))]),e("td",null,[e("div",ft,[e("button",{type:"button",class:"btn btn-outline-dark btn-sm",onClick:R=>y("edit",u)}," 編輯 ",8,ht),e("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:R=>y("delete",u)}," 刪除 ",8,vt)])])]))),128))])]),P(N,{pages:v.value,onEmitPages:p},null,8,["pages"])]),P(nt,{"temp-product":t.value,"is-new":h.value,onGetData:p,ref_key:"productModalRef",ref:g},null,8,["temp-product","is-new"]),P(W,{"temp-product":t.value,onGetData:p,ref_key:"delModalRef",ref:U},null,8,["temp-product"])],64)}}};export{Vt as default};
