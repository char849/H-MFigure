import{z as T,r as n,A as I,k as A}from"./index-N_d3GrEP.js";import{a as c}from"./axios-L6U4YIEh.js";import{S as a}from"./sweetalert2.all-qs5-l5Qo.js";var S={VITE_API:"https://vue3-course-api.hexschool.io/v2/",VITE_PATH:"charlotte-lee849",BASE_URL:"/H-MFigure/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API:u,VITE_PATH:i}=S,L=T("cartStore",()=>{const t=n(!1),o=I([]),p=n(0),f=n(0),v=n(0),d=n(""),s=()=>{t.value=!0,c.get(`${u}api/${i}/cart`).then(e=>{o.splice(0),o.push(...e.data.data.carts),p.value=e.data.data.final_total,f.value=o.reduce((r,l)=>r+l.qty,0),f.value=e.data.data.total,v.value=o.length,t.value=!1}).catch(e=>{a.fire("pinia cart:",e),t.value=!1})},m=(e,r=1)=>{if(console.log("Qty:",r),f.value+r>5){a.fire("上課人數最多不得超過5位");return}const l={product_id:e,qty:r};t.value=!0,c.post(`${u}api/${i}/cart`,{data:l}).then(()=>{t.value=!1,s(),a.fire("己加入預約清單")})},g=e=>{d.value=e,t.value=!0,c.delete(`${u}/api/${i}/cart/${e}`).then(()=>{t.value=!1,s(),d.value="",a.fire("己取消單一預約課程")}).catch(r=>{t.value=!1,a.fire(r.response.data.message)})},h=()=>{t.value=!0,c.delete(`${u}/api/${i}/carts`).then(()=>{t.value=!1,s(),a.fire("己取消所有預約課程")}).catch(e=>{t.value=!1,a.fire(e.response.data.message)})},_=()=>{a.fire({title:"確認清空預約課程",text:"您確定要清空所有預約課程嗎？",icon:"warning",showCancelButton:!0,confirmButtonText:"是的，清空",cancelButtonText:"取消",reverseButtons:!0}).then(e=>{e.isConfirmed&&h()})},$=e=>{const r={product_id:e.product_id,qty:e.qty};t.value=!0,d.value=e.id,c.put(`${u}/api/${i}/cart/${e.id}`,{data:r}).then(()=>{s(),t.value=!1,d.value="",a.fire("己更改預約人數")}).catch(l=>{t.value=!1,a.fire(l.response.data.message)})},C=()=>{v.value=0};return A(()=>{s()}),{cart:o,finalTotal:p,cartsLength:v,total:f,getCart:s,addToCart:m,removeCartItem:g,deleteAllCarts:h,confirmDeleteAllCarts:_,updateCartItem:$,clearCartLength:C}});export{L as u};
