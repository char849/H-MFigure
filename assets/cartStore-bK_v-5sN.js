import{z as I,r as o,A,k as S}from"./index-yC9jJfhG.js";import{a as c}from"./axios-L6U4YIEh.js";import{S as a}from"./sweetalert2.all-vGwb5cxU.js";var E={VITE_API:"https://vue3-course-api.hexschool.io/v2/",VITE_PATH:"charlotte-lee849",BASE_URL:"/H-MFigure/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API:u,VITE_PATH:i}=E,P=I("cartStore",()=>{const t=o(!1),l=A([]),v=o(0),p=o(0),h=o(0),d=o(0),f=o(""),s=()=>{t.value=!0,c.get(`${u}api/${i}/cart`).then(e=>{l.splice(0),l.push(...e.data.data.carts),v.value=e.data.data.final_total,h.value=l.reduce((r,n)=>r+n.qty,0),p.value=e.data.data.total,d.value=l.length,t.value=!1}).catch(e=>{a.fire("pinia cart:",e),t.value=!1})},_=(e,r=1)=>{if(h.value+r>5){a.fire("上課人數最多不得超過5位");return}const n={product_id:e,qty:r};t.value=!0,c.post(`${u}api/${i}/cart`,{data:n}).then(()=>{t.value=!1,s(),a.fire("己加入預約清單")})},g=e=>{f.value=e,t.value=!0,c.delete(`${u}/api/${i}/cart/${e}`).then(()=>{t.value=!1,s(),f.value="",a.fire("己取消單一預約課程")}).catch(r=>{t.value=!1,a.fire(r.response.data.message)})},m=()=>{t.value=!0,c.delete(`${u}/api/${i}/carts`).then(()=>{t.value=!1,s(),a.fire("己取消所有預約課程")}).catch(e=>{t.value=!1,a.fire(e.response.data.message)})},$=()=>{a.fire({title:"確認清空預約課程",text:"您確定要清空所有預約課程嗎？",icon:"warning",showCancelButton:!0,confirmButtonText:"是的，清空",cancelButtonText:"取消",reverseButtons:!0}).then(e=>{e.isConfirmed&&m()})},C=e=>{const r={product_id:e.product_id,qty:e.qty};t.value=!0,f.value=e.id,c.put(`${u}/api/${i}/cart/${e.id}`,{data:r}).then(()=>{s(),t.value=!1,f.value="",a.fire("己更改預約人數")}).catch(n=>{t.value=!1,a.fire(n.response.data.message)})},T=()=>{d.value=0};return S(()=>{s()}),{cart:l,finalTotal:v,cartsLength:d,total:p,getCart:s,addToCart:_,removeCartItem:g,deleteAllCarts:m,confirmDeleteAllCarts:$,updateCartItem:C,clearCartLength:T}});export{P as u};
